<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.jeecg.modules.marketing.mapper.MarketingGiftBagRecordBatchDeliveryMapper">
    <select id="findMarketingGiftBagRecordBatchDeliveryById" resultType="map">
        SELECT
          mgbrbd.`linkman`,
          mgbrbd.`phone`,
          mgbrbd.`area_explan` AS areaExplan,
          mgbrbd.`area_address` AS areaAddress,
          mgbrbd.`remark`,
          mgbrbd.`logistics_company` AS logisticsCompany,
          mgbrbd.`tracking_number` AS trackingNumber,
          CONCAT((SELECT
          mgbrbds.`batch_number`
        FROM
          marketing_gift_bag_record_batch_delivery mgbrbds
        WHERE mgbrbds.`id` = mgbrbd.`pid`),'~',mgbrbd.`batch_number`) AS batchNumber
        FROM
          marketing_gift_bag_record_batch_delivery mgbrbd
        WHERE mgbrbd.`del_flag` = '0'
        AND mgbrbd.`pid` != '0'
        AND mgbrbd.`marketing_gift_bag_record_batch_id` = #{map.id}
        <if test="map.phone != null and map.phone != ''">
            AND mgbrbd.phone = #{map.phone}
        </if>
        ORDER BY mgbrbd.`batch_number` ASC
    </select>
    <select id="findMarketingGiftBagRecordBatchDeliveryMap" resultType="map">
        SELECT
          mgbrbd.`id`,
          mgbrbd.`batch_number` AS batchNumber
        FROM
          marketing_gift_bag_record_batch_delivery mgbrbd
        WHERE mgbrbd.`del_flag` = '0'
          AND mgbrbd.`marketing_gift_bag_record_batch_id` = #{marketingGiftBagRecordBatchId}
        ORDER BY mgbrbd.`batch_number` ASC
    </select>
</mapper>