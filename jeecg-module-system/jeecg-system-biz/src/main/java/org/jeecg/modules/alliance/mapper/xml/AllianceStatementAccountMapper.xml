<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.jeecg.modules.alliance.mapper.AllianceStatementAccountMapper">
    <select id="queryPageList" resultType="org.jeecg.modules.alliance.vo.AllianceStatementAccountVO">
        SELECT
          asa.*,
          am.`name`,
          su.`username`,
          su.`realname`
        FROM
          alliance_statement_account asa
          LEFT JOIN alliance_manage am
            ON asa.`sys_user_id` = am.`sys_user_id`
          LEFT JOIN sys_user su
            ON asa.`sys_user_id` = su.`id`
        WHERE asa.`del_flag` = 0
        <if test="allianceStatementAccountDTO.sysUserId != null and allianceStatementAccountDTO.sysUserId != ''">
            AND asa.sys_user_id = #{allianceStatementAccountDTO.sysUserId}
        </if>
        <if test="allianceStatementAccountDTO != null and allianceStatementAccountDTO.calendarDate_begin != null and allianceStatementAccountDTO.calendarDate_begin != ''">
            AND asa.calendar_date <![CDATA[>=]]> concat(#{allianceStatementAccountDTO.calendarDate_begin},' 00:00:00')
        </if>
        <if test="allianceStatementAccountDTO != null and allianceStatementAccountDTO.calendarDate_end != null and allianceStatementAccountDTO.calendarDate_end != ''">
            AND asa.calendar_date <![CDATA[<=]]> concat( #{allianceStatementAccountDTO.calendarDate_end},' 23:59:59')
        </if>
        <if test="allianceStatementAccountDTO.username != null and allianceStatementAccountDTO.username != ''">
            AND su.username LIKE concat('%',#{allianceStatementAccountDTO.username},'%')
        </if>
        <if test="allianceStatementAccountDTO.realname != null and allianceStatementAccountDTO.realname != ''">
            AND su.realname LIKE concat('%',#{allianceStatementAccountDTO.realname},'%')
        </if>
        <if test="allianceStatementAccountDTO.name != null and allianceStatementAccountDTO.name != ''">
            AND am.`name` LIKE concat('%',#{allianceStatementAccountDTO.name},'%')
        </if>
        ORDER BY asa.`calendar_date` DESC
    </select>
</mapper>