<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.jeecg.modules.marketing.mapper.MarketingFreeSessionMapper">

    <select id="selectCurrentSession" resultType="map">
        SELECT
        serial_number AS serialNumber,
        TIMESTAMPDIFF(SECOND,NOW(),STR_TO_DATE(CONCAT(DATE_FORMAT(END_TIME, '%Y-%m-%d'),' 23:59:59'),'%Y-%m-%d %H:%i:%s')) AS surplusTime,
        id,
        (select label from marketing_free_base_setting limit 1) AS label
        FROM
        `marketing_free_session`
        WHERE del_flag = '0'
        AND STATUS = '1'
        AND DATE_FORMAT(START_TIME, '%Y-%m-%d') &lt;=DATE_FORMAT(NOW(), '%Y-%m-%d')
        AND DATE_FORMAT(END_TIME, '%Y-%m-%d') &gt;=DATE_FORMAT(NOW(), '%Y-%m-%d')
        LIMIT 1
    </select>
</mapper>