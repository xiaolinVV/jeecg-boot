<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.jeecg.modules.order.mapper.OrderRefundListMapper">

    <select id="getRefundOrderTimer" resultType="java.lang.String">
        SELECT
        IF(#{hour}>=1,TIMESTAMPDIFF(
        SECOND,
        NOW(),
        DATE_ADD(create_time, INTERVAL #{hour} HOUR)
        ),TIMESTAMPDIFF(
        SECOND,
        NOW(),
        DATE_ADD(create_time, INTERVAL #{hour}*60 MINUTE)
        )) AS timer
        FROM
        order_refund_list
        WHERE del_flag = '0'
        AND STATUS = '1'
        <if test="id != null and id != ''">
            AND id=#{id}
        </if>
    </select>

    <select id="getCancelReturnsTimeoutRefundOrderList" resultType="org.jeecg.modules.order.entity.OrderRefundList">
        SELECT
        *
        from order_refund_list
        where del_flag = '0'
        and status = '1'
        and refund_type in ('1','2')
        <if test="hour != null and hour != ''">
            and DATE_ADD(create_time, INTERVAL #{hour} HOUR) <![CDATA[<=]]>  NOW()
        </if>
        order by create_time
        limit 50
    </select>
</mapper>