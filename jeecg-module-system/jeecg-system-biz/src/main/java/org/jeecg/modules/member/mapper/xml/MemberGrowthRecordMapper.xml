<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.jeecg.modules.member.mapper.MemberGrowthRecordMapper">
    <select id="queryPageList" resultType="org.jeecg.modules.member.vo.MemberGrowthRecordVO">
        SELECT
          mgr.id,
          mgr.`order_no`,
          mgr.`member_list_id`,
          ml.`phone`,
          ml.`nick_name`,
          mgr.`trade_type`,
          mgr.`growth_value`,
          mgr.`create_time`,
          mgr.`remark`
        FROM
          member_growth_record mgr
          LEFT JOIN member_list ml
            ON ml.`id` = mgr.`member_list_id`
        WHERE mgr.`del_flag` = 0
          AND ml.`del_flag` = 0
          <if test="memberGrowthRecordDTO.orderNo != null and memberGrowthRecordDTO.orderNo!= ''">
              AND mgr.order_no LIKE concat('%',#{memberGrowthRecordDTO.orderNo},'%')
          </if>
        <if test="memberGrowthRecordDTO.memberListId != null and memberGrowthRecordDTO.memberListId!= ''">
            AND mgr.member_list_id LIKE concat('%',#{memberGrowthRecordDTO.memberListId},'%')
        </if>
        <if test="memberGrowthRecordDTO.phone != null and memberGrowthRecordDTO.phone!= ''">
            AND ml.phone LIKE concat('%',#{memberGrowthRecordDTO.phone},'%')
        </if>
        <if test="memberGrowthRecordDTO.nickName != null and memberGrowthRecordDTO.nickName!= ''">
            AND ml.nick_name LIKE concat('%',#{memberGrowthRecordDTO.nickName},'%')
        </if>
        <if test="memberGrowthRecordDTO.tradeType != null and memberGrowthRecordDTO.tradeType!= ''">
            AND mgr.trade_type = #{memberGrowthRecordDTO.tradeType}
        </if>
        <if test="memberGrowthRecordDTO != null and memberGrowthRecordDTO.createTime_begin != null and memberGrowthRecordDTO.createTime_begin != ''">
            and mgr.create_time <![CDATA[>=]]> CONCAT(#{memberGrowthRecordDTO.createTime_begin},' 00:00:00')
        </if>
        <if test="memberGrowthRecordDTO != null and memberGrowthRecordDTO.createTime_end != null and memberGrowthRecordDTO.createTime_end != ''">
            AND mgr.create_time <![CDATA[<=]]> CONCAT( #{memberGrowthRecordDTO.createTime_end},' 23:59:59')
        </if>
        ORDER BY mgr.create_time DESC
    </select>
</mapper>